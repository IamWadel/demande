<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Demande en mariage AR</title>
    
    <!-- Importation des bibliothèques A-Frame et AR.js (optimisée pour iOS) -->
    <script src="https://aframe.io/releases/1.2.0/aframe.min.js"></script>
    <script src="https://rawcdn.githack.com/jeromeetienne/AR.js/1.7.2/aframe/build/aframe-ar.min.js"></script>

    <style>
        body { margin: 0; overflow: hidden; }
    </style>
</head>
<body>

    <!-- Scène AR parfaitement adaptée à l'iPhone -->
    <a-scene 
        embedded 
        arjs="sourceType: webcam; debugUIEnabled: false;"
        renderer="antialias: true; alpha: true;">
        
        <!-- Texte flottant en AR -->
        <a-text 
            value="Veux-tu m'épouser ?" 
            position="0 1.5 -3" 
            color="gold" 
            scale="2 2 2"
            animation="property: scale; to: 2.2 2.2 2.2; dir: alternate; loop: true; dur: 1000">
        </a-text>

        <!-- Cœur flottant pour effet romantique -->
        <a-entity geometry="primitive: sphere" material="color: red" 
                  position="0 1.2 -3" scale="0.3 0.3 0.3" 
                  animation="property: position; to: 0 1.4 -3; dir: alternate; loop: true; dur: 800">
        </a-entity>

        <!-- Caméra WebAR optimisée -->
        <a-entity camera position="0 1.6 0" look-controls-enabled="true"></a-entity>

    </a-scene>

    <!-- Script pour forcer l'autorisation de la caméra sur iPhone -->
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {
                navigator.mediaDevices.getUserMedia({ video: { facingMode: "environment" } })
                .then(function (stream) {
                    console.log("Caméra activée avec succès !");
                })
                .catch(function (error) {
                    alert("Erreur : Veuillez autoriser l'accès à la caméra dans les paramètres de Safari.");
                });
            } else {
                alert("Votre appareil ne prend pas en charge WebAR.");
            }
        });
    </script>

</body>
</html>
